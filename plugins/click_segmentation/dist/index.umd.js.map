{"version":3,"file":"index.umd.js","sources":["../src/ClickSegmentation.tsx","../src/ClickSegmentationPlugin.tsx"],"sourcesContent":["import {\n  executeOperator,\n} from \"@fiftyone/operators\";\nimport * as fos from \"@fiftyone/state\";\nimport _ from \"lodash\";\nimport { useRecoilValue } from \"recoil\";\nimport styled from \"styled-components\";\nimport { useState, useRef, useCallback, useEffect } from \"react\";\n\nexport function ClickSegmentation() {\n  const modalSample = useRecoilValue(fos.modalSample);\n  const [clicks, setClicks] = useState([]);\n  const [isCapturing, setIsCapturing] = useState(false);\n  const [isSingleClick, setSingleClick] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [fieldName, setFieldName] = useState(\"user_clicks\");\n  const [modelName, setModelName] = useState(\"segment-anything-2-hiera-tiny-image-torch\");\n  const [labelName, setLabelName] = useState(\"label\");\n\n  useEffect(() => {\n    setClicks([]);\n  }, [modalSample?.sample?._id]);\n\n  useEffect(() => {\n    if (!isCapturing || !modalSample) return;\n\n    const handleCanvasClick = async (event: MouseEvent) => {\n      const canvas = event.target as HTMLCanvasElement;\n      if (canvas.tagName !== \"CANVAS\") return;    \n      if (isProcessing) return;\n\n      const rect = canvas.getBoundingClientRect();\n      const metadata = modalSample.sample.metadata;\n    \n      if (!metadata?.width || !metadata?.height) {\n        console.error(\"No image metadata available\");\n        return;\n      }\n\n      // Calculate the relative position of the click\n      // NOTE: Sample modal displays the image in contain mode filling one dimension while keeping the aspect\n      // ratio. It is possible to zoom in and out in the model which will break the correct image coord capture.\n      // TODO: Fix this for when image width and height are both smaller than that of modal canvas.\n      const imageAspect = metadata.width / metadata.height;\n      const canvasAspect = rect.width / rect.height;\n    \n      let imgWidth, imgHeight, imgOffsetX, imgOffsetY;\n    \n      if (imageAspect > canvasAspect) {\n        // Image fills width only\n        imgWidth = rect.width;\n        imgHeight = rect.width / imageAspect;\n        imgOffsetX = 0;\n        imgOffsetY = (rect.height - imgHeight) / 2;\n      } else {\n        // Image fills height\n        imgHeight = rect.height;\n        imgWidth = rect.height * imageAspect;\n        imgOffsetX = (rect.width - imgWidth) / 2;\n        imgOffsetY = 0;\n      }\n    \n      const canvasX = event.clientX - rect.left;\n      const canvasY = event.clientY - rect.top;\n      const imgX = canvasX - imgOffsetX;\n      const imgY = canvasY - imgOffsetY;\n\n      if (imgX < 0 || imgX > imgWidth || imgY < 0 || imgY > imgHeight) {\n        console.log(\"Click outside image bounds\");\n        return;\n      }\n    \n      const normalizedX = imgX / imgWidth;\n      const normalizedY = imgY / imgHeight;    \n      const clickData = {\n        normalizedX: parseFloat(normalizedX.toFixed(4)),\n        normalizedY: parseFloat(normalizedY.toFixed(4)),\n      };\n    \n      console.log(\"Click captured:\", clickData);\n      if (isSingleClick) {\n        await autoSegmentWithSingleKeypoint(clickData);\n      } else {\n        setClicks((prev) => [...prev, clickData]);\n      }\n    };\n\n    document.addEventListener(\"click\", handleCanvasClick, true);\n    return () => document.removeEventListener(\"click\", handleCanvasClick, true);\n  }, [isCapturing, modalSample, isSingleClick, isProcessing, modelName, fieldName]);\n\n  const saveAsKeypoints = async () => {\n    if (!fieldName.trim()) {\n      alert(\"Please enter a field name\");\n      return;\n    }\n\n    const keypointCoords = clicks.map(click => [\n      click.normalizedX,\n      click.normalizedY,\n    ]);\n    \n    try {\n      await executeOperator(\n        \"@51labs/click_segmentation/save_keypoints\",\n        {\n          keypoints: keypointCoords,\n          field_name: fieldName.trim(),\n          label_name: labelName.trim()\n        }\n      );\n      setClicks([]);\n    } catch (error) {\n      console.error(\"Error saving keypoints:\", error);\n      alert(`Failed: ${error.message}`);\n    }\n  };\n\n  const autoSegmentWithSingleKeypoint = async (clickData) => {\n    setIsProcessing(true);\n\n    const keypointCoords = [[clickData.normalizedX, clickData.normalizedY]];\n    try {\n      console.log(\"Auto segmenting with \", clickData);\n      await executeOperator(\n        \"@51labs/click_segmentation/save_keypoints\",\n        {\n          keypoints: keypointCoords,\n          field_name: fieldName.trim(),\n          label_name: labelName.trim()\n        }\n      );\n      // Add a delay to ensure keypoints are available\n      // TODO: Remove delay. Find a better fix.\n      await new Promise(resolve => setTimeout(resolve, 10));\n      await executeOperator(\n        \"@51labs/click_segmentation/segment_with_prompts\",\n        {\n          prompt_field: fieldName.trim(),\n          model_name: modelName.trim()\n        }\n      );\n      setClicks([])\n    } catch (error) {\n      console.error(\"Error auto segmenting:\", error);\n      alert(`Failed: ${error.message}`);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const segmentWithKeypoints = async () => {\n    try {\n      await executeOperator(\n        \"@51labs/click_segmentation/segment_with_prompts\",\n        {\n          prompt_field: fieldName.trim(),\n          model_name: modelName.trim()\n        }\n      );\n    } catch (error) {\n      console.error(\"Error saving keypoints:\", error);\n      alert(`Failed: ${error.message}`);\n    }\n  };\n\n  const clearClicks = () => {\n    setClicks([]);\n  };\n  \n  return (\n    <div style={{ padding: \"20px\", display: \"flex\", flexDirection: \"column\", height: \"100%\" }}>\n      <div style={{ marginBottom: \"10px\" }}>\n        <h3 style={{ margin: 0 }}>Image segmentation via point prompts</h3>\n      </div>\n      \n      {/* Capture toggle on/off*/}\n      <div style={{ \n        marginBottom: \"20px\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        padding: \"15px\",\n        backgroundColor: isCapturing ? \"#e3f2fd\" : \"#f5f5f5\",\n        borderRadius: \"8px\",\n        border: `2px solid ${isCapturing ? \"#2196F3\" : \"#ddd\"}`,\n        transition: \"all 0.3s ease\"\n      }}>\n        <label style={{ \n          display: \"flex\", \n          alignItems: \"center\", \n          gap: \"10px\", \n          cursor: \"pointer\" \n        }}>\n          <input \n            type=\"checkbox\"\n            checked={isCapturing}\n            onChange={(e) => setIsCapturing(e.target.checked)}\n            style={{ \n              width: \"20px\", \n              height: \"20px\", \n              cursor: \"pointer\" \n            }}\n          />\n          <span style={{ \n            fontWeight: \"bold\", \n            fontSize: \"15px\",\n            color: isCapturing ? \"#1976d2\" : \"#666\"\n          }}>\n            {isCapturing ? \"Capturing Clicks\" : \"Activate Click Capture\"}\n          </span>\n        </label>\n        {isCapturing && (\n          <p style={{ \n            fontSize: \"12px\", \n            color: \"#1976d2\", \n            margin: \"8px 0 0 30px\",\n            fontWeight: \"500\"\n          }}>\n            Click anywhere on the modal image to capture keypoints.\n          </p>\n        )}\n      </div>\n\n      {/* Field name input */}\n      <div style={{ \n        marginBottom: \"8px\", \n        padding: \"4px\",\n      }}>\n        <label style={{ \n          display: \"flex\", \n          flexDirection: \"column\", \n          gap: \"8px\",\n          fontSize: \"14px\"\n        }}>\n          <span style={{ fontSize: \"14px\", color: \"#666\" }}>\n            Sample field name for saving clicks (as keypoints)\n          </span>\n          <input \n            type=\"text\"\n            value={fieldName}\n            onChange={(e) => setFieldName(e.target.value)}\n            placeholder=\"e.g., user_clicks, keypoints\"\n            style={{\n              padding: \"8px 12px\",\n              border: \"1px solid #ccc\",\n              borderRadius: \"4px\",\n              fontSize: \"14px\",\n              fontFamily: \"monospace\"\n            }}\n          />\n        </label>\n      </div>\n\n      {/* Keypoint label name input */}\n      <div style={{ \n        marginBottom: \"8px\", \n        padding: \"4px\",\n      }}>\n        <label style={{ \n          display: \"flex\", \n          flexDirection: \"column\", \n          gap: \"8px\",\n          fontSize: \"14px\"\n        }}>\n          <span style={{ fontSize: \"14px\", color: \"#666\" }}>\n            Label name for the current set of clicks\n          </span>\n          <input \n            type=\"text\"\n            value={labelName}\n            onChange={(e) => setLabelName(e.target.value)}\n            placeholder=\"e.g., animal, person\"\n            style={{\n              padding: \"8px 12px\",\n              border: \"1px solid #ccc\",\n              borderRadius: \"4px\",\n              fontSize: \"14px\",\n              fontFamily: \"monospace\"\n            }}\n          />\n        </label>\n      </div>\n\n      {/* Single click execution */}\n      <div style={{ \n        marginBottom: \"20px\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        padding: \"15px\",\n        backgroundColor: isSingleClick ? \"#e3f2fd\" : \"#f5f5f5\",\n        borderRadius: \"8px\",\n        border: `2px solid ${isSingleClick ? \"#2196F3\" : \"#ddd\"}`,\n        transition: \"all 0.3s ease\"\n      }}>\n        <label style={{ \n          display: \"flex\", \n          alignItems: \"center\", \n          gap: \"10px\", \n          cursor: \"pointer\" \n        }}>\n          <input \n            type=\"checkbox\"\n            checked={isSingleClick}\n            onChange={(e) => setSingleClick(e.target.checked)}\n            style={{ \n              width: \"20px\", \n              height: \"20px\", \n              cursor: \"pointer\" \n            }}\n          />\n          <span style={{ \n            fontWeight: \"bold\", \n            fontSize: \"15px\",\n            color: isSingleClick ? \"#1976d2\" : \"#666\"\n          }}>\n            {isSingleClick ? \"Single Click Segmentation\" : \"Enable Single Click Segmentation\"}\n          </span>\n        </label>\n        {isSingleClick && (\n          <p style={{ \n            fontSize: \"12px\", \n            color: \"#1976d2\", \n            margin: \"8px 0 0 30px\",\n            fontWeight: \"500\"\n          }}>\n            Single click segmentation is enabled. Clicking on the modal will auto-generate segmentation.\n          </p>\n        )}\n      </div>\n\n      {/* Keypoint buttons */}\n      <div style={{ marginBottom: \"10px\", display: \"flex\", gap: \"10px\" }}>\n      <button \n          onClick={saveAsKeypoints}\n          disabled={(isSingleClick) || (clicks.length === 0)}\n          style={{\n            padding: \"8px 16px\",\n            backgroundColor: (!isSingleClick) && (clicks.length > 0) ? \"#2196F3\" : \"#ccc\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: (!isSingleClick) && (clicks.length > 0) ? \"pointer\" : \"not-allowed\",\n            fontWeight: \"bold\"\n          }}\n        >\n          Save as Keypoints ({clicks.length})\n        </button>\n        <button \n          onClick={clearClicks}\n          disabled={(isSingleClick) || (clicks.length === 0)}\n          style={{\n            padding: \"8px 16px\",\n            backgroundColor: (!isSingleClick) || (clicks.length > 0) ? \"#2196F3\" : \"#ccc\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: (!isSingleClick) && (clicks.length > 0) ? \"pointer\" : \"not-allowed\",\n          }}\n        >\n          Clear Clicks ({clicks.length})\n        </button>\n      </div>\n\n      {/* Model name input */}\n      <div style={{ \n        marginBottom: \"8px\", \n        padding: \"4px\",\n      }}>\n        <label style={{ \n          display: \"flex\", \n          flexDirection: \"column\", \n          gap: \"8px\",\n          fontSize: \"14px\"\n        }}>\n          <span style={{ fontSize: \"14px\", color: \"#666\" }}>\n            Promptable segmentation model from FiftyOne model zoo\n          </span>\n          <input \n            type=\"text\"\n            value={modelName}\n            onChange={(e) => setModelName(e.target.value)}\n            placeholder=\"e.g., segment-anything-2-hiera-small-image-torch\"\n            style={{\n              padding: \"8px 12px\",\n              border: \"1px solid #ccc\",\n              borderRadius: \"4px\",\n              fontSize: \"14px\",\n              fontFamily: \"monospace\"\n            }}\n          />\n        </label>\n      </div>\n\n      {/* Segment with keypoints button */}\n      <div style={{ marginBottom: \"10px\", display: \"flex\", gap: \"10px\" }}>\n        <button \n          onClick={segmentWithKeypoints}\n          disabled={isSingleClick}\n          style={{\n            padding: \"8px 16px\",\n            backgroundColor: (!isSingleClick) ? \"#2196F3\" : \"#ccc\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"4px\",\n            cursor: (!isSingleClick) ? \"pointer\" : \"not-allowed\",\n            fontWeight: \"bold\"\n          }}\n        >\n          Segment with keypoints\n        </button>\n      </div>\n    </div>\n  );\n}","import { PluginComponentType, registerComponent } from \"@fiftyone/plugins\";\nimport { ClickSegmentation } from \"./ClickSegmentation\";\n\nregisterComponent({\n  name: \"ClickSegmentation\",\n  label: \"Click To Segment\",\n  component: ClickSegmentation,\n  type: PluginComponentType.Panel,\n  activator: myActivator,\n  panelOptions: {\n    surfaces: \"modal\",\n  },\n});\n\nfunction myActivator({ dataset }) {\n  return true;\n}\n"],"names":["ClickSegmentation","modalSample","useRecoilValue","fos","clicks","setClicks","useState","isCapturing","setIsCapturing","isSingleClick","setSingleClick","isProcessing","setIsProcessing","fieldName","setFieldName","modelName","setModelName","labelName","setLabelName","useEffect","_a","handleCanvasClick","event","canvas","rect","metadata","imageAspect","canvasAspect","imgWidth","imgHeight","imgOffsetX","imgOffsetY","canvasX","canvasY","imgX","imgY","normalizedX","normalizedY","clickData","autoSegmentWithSingleKeypoint","prev","saveAsKeypoints","keypointCoords","click","executeOperator","error","resolve","segmentWithKeypoints","clearClicks","registerComponent","PluginComponentType","myActivator","dataset"],"mappings":"wtBASO,SAASA,GAAoB,OAClC,MAAMC,EAAcC,EAAAA,eAAeC,EAAI,WAAW,EAC5C,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAAS,CAAA,CAAE,EACjC,CAACC,EAAaC,CAAc,EAAIF,EAAAA,SAAS,EAAK,EAC9C,CAACG,EAAeC,CAAc,EAAIJ,EAAAA,SAAS,EAAK,EAChD,CAACK,EAAcC,CAAe,EAAIN,EAAAA,SAAS,EAAK,EAChD,CAACO,EAAWC,CAAY,EAAIR,EAAAA,SAAS,aAAa,EAClD,CAACS,EAAWC,CAAY,EAAIV,EAAAA,SAAS,2CAA2C,EAChF,CAACW,EAAWC,CAAY,EAAIZ,EAAAA,SAAS,OAAO,EAElDa,EAAAA,UAAU,IAAM,CACdd,EAAU,CAAA,CAAE,CACd,EAAG,EAACe,EAAAnB,GAAA,YAAAA,EAAa,SAAb,YAAAmB,EAAqB,GAAG,CAAC,EAE7BD,EAAAA,UAAU,IAAM,CACd,GAAI,CAACZ,GAAe,CAACN,EAAa,OAElC,MAAMoB,EAAoB,MAAOC,GAAsB,CACrD,MAAMC,EAASD,EAAM,OAErB,GADIC,EAAO,UAAY,UACnBZ,EAAc,OAElB,MAAMa,EAAOD,EAAO,sBAAA,EACdE,EAAWxB,EAAY,OAAO,SAEpC,GAAI,EAACwB,GAAA,MAAAA,EAAU,QAAS,EAACA,GAAA,MAAAA,EAAU,QAAQ,CACzC,QAAQ,MAAM,6BAA6B,EAC3C,MACF,CAMA,MAAMC,EAAcD,EAAS,MAAQA,EAAS,OACxCE,EAAeH,EAAK,MAAQA,EAAK,OAEvC,IAAII,EAAUC,EAAWC,EAAYC,EAEjCL,EAAcC,GAEhBC,EAAWJ,EAAK,MAChBK,EAAYL,EAAK,MAAQE,EACzBI,EAAa,EACbC,GAAcP,EAAK,OAASK,GAAa,IAGzCA,EAAYL,EAAK,OACjBI,EAAWJ,EAAK,OAASE,EACzBI,GAAcN,EAAK,MAAQI,GAAY,EACvCG,EAAa,GAGf,MAAMC,EAAUV,EAAM,QAAUE,EAAK,KAC/BS,EAAUX,EAAM,QAAUE,EAAK,IAC/BU,EAAOF,EAAUF,EACjBK,EAAOF,EAAUF,EAEvB,GAAIG,EAAO,GAAKA,EAAON,GAAYO,EAAO,GAAKA,EAAON,EAAW,CAC/D,QAAQ,IAAI,4BAA4B,EACxC,MACF,CAEA,MAAMO,EAAcF,EAAON,EACrBS,EAAcF,EAAON,EACrBS,EAAY,CAChB,YAAa,WAAWF,EAAY,QAAQ,CAAC,CAAC,EAC9C,YAAa,WAAWC,EAAY,QAAQ,CAAC,CAAC,CAAA,EAGhD,QAAQ,IAAI,kBAAmBC,CAAS,EACpC7B,EACF,MAAM8B,EAA8BD,CAAS,EAE7CjC,EAAWmC,GAAS,CAAC,GAAGA,EAAMF,CAAS,CAAC,CAE5C,EAEA,gBAAS,iBAAiB,QAASjB,EAAmB,EAAI,EACnD,IAAM,SAAS,oBAAoB,QAASA,EAAmB,EAAI,CAC5E,EAAG,CAACd,EAAaN,EAAaQ,EAAeE,EAAcI,EAAWF,CAAS,CAAC,EAEhF,MAAM4B,EAAkB,SAAY,CAClC,GAAI,CAAC5B,EAAU,OAAQ,CACrB,MAAM,2BAA2B,EACjC,MACF,CAEA,MAAM6B,EAAiBtC,EAAO,IAAIuC,GAAS,CACzCA,EAAM,YACNA,EAAM,WAAA,CACP,EAED,GAAI,CACF,MAAMC,EAAAA,gBACJ,4CACA,CACE,UAAWF,EACX,WAAY7B,EAAU,KAAA,EACtB,WAAYI,EAAU,KAAA,CAAK,CAC7B,EAEFZ,EAAU,CAAA,CAAE,CACd,OAASwC,EAAO,CACd,QAAQ,MAAM,0BAA2BA,CAAK,EAC9C,MAAM,WAAWA,EAAM,OAAO,EAAE,CAClC,CACF,EAEMN,EAAgC,MAAOD,GAAc,CACzD1B,EAAgB,EAAI,EAEpB,MAAM8B,EAAiB,CAAC,CAACJ,EAAU,YAAaA,EAAU,WAAW,CAAC,EACtE,GAAI,CACF,QAAQ,IAAI,wBAAyBA,CAAS,EAC9C,MAAMM,EAAAA,gBACJ,4CACA,CACE,UAAWF,EACX,WAAY7B,EAAU,KAAA,EACtB,WAAYI,EAAU,KAAA,CAAK,CAC7B,EAIF,MAAM,IAAI,QAAQ6B,GAAW,WAAWA,EAAS,EAAE,CAAC,EACpD,MAAMF,EAAAA,gBACJ,kDACA,CACE,aAAc/B,EAAU,KAAA,EACxB,WAAYE,EAAU,KAAA,CAAK,CAC7B,EAEFV,EAAU,CAAA,CAAE,CACd,OAASwC,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAC7C,MAAM,WAAWA,EAAM,OAAO,EAAE,CAClC,QAAA,CACEjC,EAAgB,EAAK,CACvB,CACF,EAEMmC,EAAuB,SAAY,CACvC,GAAI,CACF,MAAMH,EAAAA,gBACJ,kDACA,CACE,aAAc/B,EAAU,KAAA,EACxB,WAAYE,EAAU,KAAA,CAAK,CAC7B,CAEJ,OAAS8B,EAAO,CACd,QAAQ,MAAM,0BAA2BA,CAAK,EAC9C,MAAM,WAAWA,EAAM,OAAO,EAAE,CAClC,CACF,EAEMG,EAAc,IAAM,CACxB3C,EAAU,CAAA,CAAE,CACd,EAEA,OACE,MAAA,cAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,QAAS,OAAQ,cAAe,SAAU,OAAQ,MAAA,CAAO,sBACrF,MAAA,CAAI,MAAO,CAAE,aAAc,OAAO,EACjC,MAAA,cAAC,KAAA,CAAG,MAAO,CAAE,OAAQ,CAAA,CAAE,EAAG,sCAAoC,CAChE,EAGA,MAAA,cAAC,OAAI,MAAO,CACV,aAAc,OACd,QAAS,OACT,cAAe,SACf,QAAS,OACT,gBAAiBE,EAAc,UAAY,UAC3C,aAAc,MACd,OAAQ,aAAaA,EAAc,UAAY,MAAM,GACrD,WAAY,eAAA,CACd,EACE,MAAA,cAAC,QAAA,CAAM,MAAO,CACZ,QAAS,OACT,WAAY,SACZ,IAAK,OACL,OAAQ,SAAA,CACV,EACE,MAAA,cAAC,QAAA,CACC,KAAK,WACL,QAASA,EACT,SAAW,GAAMC,EAAe,EAAE,OAAO,OAAO,EAChD,MAAO,CACL,MAAO,OACP,OAAQ,OACR,OAAQ,SAAA,CACV,CAAA,EAEF,MAAA,cAAC,OAAA,CAAK,MAAO,CACX,WAAY,OACZ,SAAU,OACV,MAAOD,EAAc,UAAY,MAAA,CACnC,EACGA,EAAc,mBAAqB,wBACtC,CACF,EACCA,GACC,MAAA,cAAC,IAAA,CAAE,MAAO,CACR,SAAU,OACV,MAAO,UACP,OAAQ,eACR,WAAY,KAAA,GACX,yDAEH,CAEJ,EAGA,MAAA,cAAC,OAAI,MAAO,CACV,aAAc,MACd,QAAS,KAAA,CACX,EACE,MAAA,cAAC,QAAA,CAAM,MAAO,CACZ,QAAS,OACT,cAAe,SACf,IAAK,MACL,SAAU,MAAA,CACZ,EACE,MAAA,cAAC,OAAA,CAAK,MAAO,CAAE,SAAU,OAAQ,MAAO,MAAA,CAAO,EAAG,oDAElD,EACA,MAAA,cAAC,QAAA,CACC,KAAK,OACL,MAAOM,EACP,SAAW,GAAMC,EAAa,EAAE,OAAO,KAAK,EAC5C,YAAY,+BACZ,MAAO,CACL,QAAS,WACT,OAAQ,iBACR,aAAc,MACd,SAAU,OACV,WAAY,WAAA,CACd,CAAA,CAEJ,CACF,EAGA,MAAA,cAAC,OAAI,MAAO,CACV,aAAc,MACd,QAAS,KAAA,CACX,EACE,MAAA,cAAC,QAAA,CAAM,MAAO,CACZ,QAAS,OACT,cAAe,SACf,IAAK,MACL,SAAU,MAAA,CACZ,EACE,MAAA,cAAC,OAAA,CAAK,MAAO,CAAE,SAAU,OAAQ,MAAO,MAAA,CAAO,EAAG,0CAElD,EACA,MAAA,cAAC,QAAA,CACC,KAAK,OACL,MAAOG,EACP,SAAW,GAAMC,EAAa,EAAE,OAAO,KAAK,EAC5C,YAAY,uBACZ,MAAO,CACL,QAAS,WACT,OAAQ,iBACR,aAAc,MACd,SAAU,OACV,WAAY,WAAA,CACd,CAAA,CAEJ,CACF,EAGA,MAAA,cAAC,OAAI,MAAO,CACV,aAAc,OACd,QAAS,OACT,cAAe,SACf,QAAS,OACT,gBAAiBT,EAAgB,UAAY,UAC7C,aAAc,MACd,OAAQ,aAAaA,EAAgB,UAAY,MAAM,GACvD,WAAY,eAAA,CACd,EACE,MAAA,cAAC,QAAA,CAAM,MAAO,CACZ,QAAS,OACT,WAAY,SACZ,IAAK,OACL,OAAQ,SAAA,CACV,EACE,MAAA,cAAC,QAAA,CACC,KAAK,WACL,QAASA,EACT,SAAW,GAAMC,EAAe,EAAE,OAAO,OAAO,EAChD,MAAO,CACL,MAAO,OACP,OAAQ,OACR,OAAQ,SAAA,CACV,CAAA,EAEF,MAAA,cAAC,OAAA,CAAK,MAAO,CACX,WAAY,OACZ,SAAU,OACV,MAAOD,EAAgB,UAAY,MAAA,CACrC,EACGA,EAAgB,4BAA8B,kCACjD,CACF,EACCA,GACC,MAAA,cAAC,IAAA,CAAE,MAAO,CACR,SAAU,OACV,MAAO,UACP,OAAQ,eACR,WAAY,KAAA,CACd,EAAG,8FAEH,CAEJ,sBAGC,MAAA,CAAI,MAAO,CAAE,aAAc,OAAQ,QAAS,OAAQ,IAAK,OAAO,EACjE,MAAA,cAAC,SAAA,CACG,QAASgC,EACT,SAAWhC,GAAmBL,EAAO,SAAW,EAChD,MAAO,CACL,QAAS,WACT,gBAAkB,CAACK,GAAmBL,EAAO,OAAS,EAAK,UAAY,OACvE,MAAO,QACP,OAAQ,OACR,aAAc,MACd,OAAS,CAACK,GAAmBL,EAAO,OAAS,EAAK,UAAY,cAC9D,WAAY,MAAA,CACd,EACD,sBACqBA,EAAO,OAAO,GAAA,EAEpC,MAAA,cAAC,SAAA,CACC,QAAS4C,EACT,SAAWvC,GAAmBL,EAAO,SAAW,EAChD,MAAO,CACL,QAAS,WACT,gBAAkB,CAACK,GAAmBL,EAAO,OAAS,EAAK,UAAY,OACvE,MAAO,QACP,OAAQ,OACR,aAAc,MACd,OAAS,CAACK,GAAmBL,EAAO,OAAS,EAAK,UAAY,aAAA,CAChE,EACD,iBACgBA,EAAO,OAAO,GAAA,CAEjC,EAGA,MAAA,cAAC,MAAA,CAAI,MAAO,CACV,aAAc,MACd,QAAS,KAAA,CACX,EACE,MAAA,cAAC,QAAA,CAAM,MAAO,CACZ,QAAS,OACT,cAAe,SACf,IAAK,MACL,SAAU,MAAA,CACZ,EACE,MAAA,cAAC,OAAA,CAAK,MAAO,CAAE,SAAU,OAAQ,MAAO,MAAA,CAAO,EAAG,uDAElD,EACA,MAAA,cAAC,QAAA,CACC,KAAK,OACL,MAAOW,EACP,SAAW,GAAMC,EAAa,EAAE,OAAO,KAAK,EAC5C,YAAY,mDACZ,MAAO,CACL,QAAS,WACT,OAAQ,iBACR,aAAc,MACd,SAAU,OACV,WAAY,WAAA,CACd,CAAA,CAEJ,CACF,EAGA,MAAA,cAAC,MAAA,CAAI,MAAO,CAAE,aAAc,OAAQ,QAAS,OAAQ,IAAK,OAAO,EAC/D,MAAA,cAAC,SAAA,CACC,QAAS+B,EACT,SAAUtC,EACV,MAAO,CACL,QAAS,WACT,gBAAmBA,EAA6B,OAAZ,UACpC,MAAO,QACP,OAAQ,OACR,aAAc,MACd,OAAUA,EAA6B,cAAZ,UAC3B,WAAY,MAAA,CACd,EACD,wBAAA,CAGH,CACF,CAEJ,CC1ZAwC,EAAAA,kBAAkB,CAChB,KAAM,oBACN,MAAO,mBACP,UAAWjD,EACX,KAAMkD,EAAAA,oBAAoB,MAC1B,UAAWC,EACX,aAAc,CACZ,SAAU,OAAA,CAEd,CAAC,EAED,SAASA,EAAY,CAAE,QAAAC,GAAW,CAChC,MAAO,EACT"}